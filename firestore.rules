rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Users can read/write their own profile
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Likes can only be read/written by sender or receiver
    match /likes/{likeId} {
      allow read, write: if request.auth != null && (
        request.auth.uid == resource.data.from || request.auth.uid == resource.data.to
      );
    }

    // Matches can only be read by users in match
    match /matches/{matchId} {
      allow read, create: if request.auth != null && request.auth.uid in request.resource.data.users;
      allow update, delete: if false; // optional: disable editing matches
    }

    // Chats can only be read/written by participants
    match /chats/{chatId} {
      allow read, write: if request.auth != null && request.auth.uid in resource.data.users;
    }
  }
}
